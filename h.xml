<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="hello world example" /> 
  <Content type="html">
     <![CDATA[ 
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<div class="container-fluid" id="search-form">
    <h1 id="demo">Search Gadget2</h1>
    <button id="button-search" type="button" class="btn btn-default pull-right" onclick="search();">Search</button>
</div>

<div class="container-fluid table-responsive" id="search-body">
    <table  class="table table-bordered  table-hover table-striped table-condensed">
        <tbody></tbody>
    </table>
</div>

<script>
    var SheetApi = function (sheetId, apiKey) {
        var baseUrl = 'https://sheets.googleapis.com/v4/spreadsheets/' + sheetId;

        var getQueryParameters = function () {
            return {
                key : apiKey
            };
        };

        function getSheet(sheet) {
            return $.get(baseUrl + "/values/" + sheet, getQueryParameters());
        };

        return {
            listSheets : function () {
                return $.get(baseUrl, getQueryParameters());
            },
            getSheet1 : function (range) {
                return getSheet('Sheet1' + (range ? ('!' + range) : ''));
            }
        };
    }(
        "1wGy8ABua1GReuwW2vwAmMMbLOvwKh-b9TQ54IBA9fmE",
        "AIzaSyDIs2fHGHxFLWE-O5hLdBtxhZdfx1Jjld4"
    );

    function search() {
        var searchButton = $('#button-search');
        searchButton.attr('disabled', true);

        var container = $('#search-body table tbody');
        container.html("");

        SheetApi.getSheet1("A1:AA").done(function (data) {
            var header = data.values.shift();
            var body = data.values.reduce(function (body, item) {
                return body
                    + "<tr><td>" + item.join('</td><td>') + "</td></tr>";
            }, "");

            $('#search-body table tbody').html(
                "<tr><th>" + header.join('</th><th>') + "</th></tr>"
                + body
            );
        }).fail(function () {

        }).always(function () {
            searchButton.attr('disabled', false);
        });

    }

</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
     ]]>
  </Content> 
</Module>
